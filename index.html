<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fork-awesome@1.2.0/css/fork-awesome.min.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-My-New-Post" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/05/04/My-New-Post/" class="article-date">
  <time class="dt-published" datetime="2025-05-04T12:41:56.000Z" itemprop="datePublished">2025-05-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2025/05/04/My-New-Post/">My New Post</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h4><p>文件用Exeinfo PE打开，无壳用ida64位打开</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20241201201048229.png" alt="image-20241201201048229"></p>
<p>F5跳转到C语言界面，可以发现明文</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20241201201119469.png" alt="image-20241201201119469"></p>
<h4 id="rc4"><a href="#rc4" class="headerlink" title="rc4"></a>rc4</h4><p>无壳，用ida64打开，发现为rc4加密可以直接用动调拿flag，在输入后面下断点按F9后选择动调方式再按F9进入。</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20241201201205003.png" alt="image-20241201201205003"></p>
<p>输入随便21位字符串，进入后双击Str也就是我们输入的数组，右击选择到Change byte 将v5中的数据粘贴进去。</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20241201201230742.png" alt="image-20241201201230742"></p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20241201201255830.png" alt="image-20241201201255830"></p>
<p>换完数据之后按F8步过运行，过完加密函数之后，随后发现flag。</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20241201201304346.png" alt="image-20241201201304346"></p>
<h4 id="Baby-c"><a href="#Baby-c" class="headerlink" title="Baby c"></a>Baby c</h4><p>附件里是一个.h和.c文件，.h文件里定义了一堆宏，用特殊符号代表不同的数据类型和变量名等等，只需要把关键的一些变量名和运算换一下就明白了，就是先异或0x12，然后+1，然后和正确的加密结果进行比较。</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20241201201456598.png" alt="image-20241201201456598"></p>
<p>写个脚本将过程逆过来。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"></span><br><span class="line">int main() &#123;</span><br><span class="line">    unsigned char enc[] = &#123;0x49, 0x56, 0x52, 0x47, 0x55, 0x6a, 0x56, 0x7e, 0x23, 0x57,</span><br><span class="line">                           0x4e, 0x79, 0x23, 0x51, 0x4e, 0x54, 0x67, 0x4e, 0x72, 0x5f,</span><br><span class="line">                           0x74, 0x7d, 0x56, 0x68, 0x74, 0x76, 0x58, 0x70&#125;;</span><br><span class="line">    int len = sizeof(enc) / sizeof(enc[0]);</span><br><span class="line"></span><br><span class="line">    for (int i = 0; i &lt; len; i++) &#123;</span><br><span class="line">        printf(&quot;%c&quot;, (enc[i] - 1) ^ 0x12);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="汇编"><a href="#汇编" class="headerlink" title="汇编"></a>汇编</h4><p>打开txt文件开头即为将数据储存到某个寄存器内</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20241201201735264.png" alt="image-20241201201735264"></p>
<p>加密逻辑为后半部分，先进行异或和0x4D后加0x14</p>
<p>有的友友说看不懂怎么办</p>
<p>没关系放到ChatGPT里就能轻松解决</p>
<p>十分友好哈</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20241201202211133.png" alt="image-20241201202211133"></p>
<p>然后就可以写一个脚本给它逆过来</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"></span><br><span class="line">int main() &#123;</span><br><span class="line">    unsigned char encrypted[] = &#123;</span><br><span class="line">        0x3F, 0x35, 0x40, 0x3E, 0x4A, 0x1D, 0x91, 0x26,</span><br><span class="line">        0x48, 0x36, 0x4C, 0x26, 0x35, 0x38, 0x3A, 0x3C,</span><br><span class="line">        0x26, 0x1C, 0x4B, 0x26, 0x42, 0x91, 0x34, 0x51,</span><br><span class="line">        0x38, 0x35, 0x8D, 0x4D, 0x38, 0x91, 0x37, 0x44,</span><br><span class="line">        0x61</span><br><span class="line">    &#125;;</span><br><span class="line">    int length = sizeof(encrypted) / sizeof(encrypted[0]);</span><br><span class="line"></span><br><span class="line">    for (int i = 0; i &lt; length; i++) &#123;</span><br><span class="line">        unsigned char c = encrypted[i];</span><br><span class="line">        c -= 0x14;</span><br><span class="line">        c ^= 0x4D;</span><br><span class="line">        printf(&quot;%c&quot;, c);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="maze"><a href="#maze" class="headerlink" title="maze"></a>maze</h4><p>无壳，ida64直接打开f5找到主函数部分，除去初始化、printf、scanf重要的地方为框出来的，双击进入。</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20241201202521665.png" alt="image-20241201202521665"></p>
<p>迷宫题找其走出来的路径和表达方式如图1、2部分分别为表达方式和迷宫本身</p>
<p>且由v7、v8那可知迷宫本身为14*14样子的</p>
<p>并且看流程可以指导在不碰到#的情况下到达69即成功</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20241201203708950.png" alt="image-20241201203708950"></p>
<p>进入2部分</p>
<p>选中数据按shift+e可以发现迷宫是由s.#组成转换成数字类型</p>
<p>然后走一下</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20241201204006699.png" alt="image-20241201204006699"></p>
<p>进入1部分发现迷宫是wsad类分别为上下左右，对着路线写一下对应字母dsssddwwddssdddsssssdddssssaaaawwwawaasssss</p>
<p>路线要套一下ZGCTF</p>
<p>所以flag是ZGCTF{dsssddwwddssdddsssssdddssssaaaawwwawaasssss}</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20241201202830710.png" alt="image-20241201202830710"></p>
<h4 id="smc"><a href="#smc" class="headerlink" title="smc"></a>smc</h4><p>先搜一下smc是什么</p>
<p>参考一下<a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/15114?time__1311=GqjxuQD=9xlx0nD2DU2DmxmTF3XWG8AmIeD">https://xz.aliyun.com/t/15114?time__1311=GqjxuQD%3D9xlx0nD2DU2DmxmTF3XWG8AmIeD</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/sK07XdAy/p/18213011">https://www.cnblogs.com/sK07XdAy/p/18213011</a></p>
<p>同时一般伴随着SMC出现的还有<br>VirtualProtect一函数为标志</p>
<p>所以这道题肯定要用到动态调试和函数的修复</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20241201204442247.png" alt="image-20241201204442247"></p>
<p>无壳，ida32打开，shift+f12进入字符串界面找到比较厉害的字符借此进入到关键的函数部分</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20241201204952097.png" alt="image-20241201204952097"></p>
<p>顺着函数思路点击sub_463E9B即可发现VirtualProtect函数标红</p>
<p>所以断点下在下面那个部分</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20241201205824302.png" alt="image-20241201205824302"></p>
<p>然后进入动调按f7单步进行</p>
<p>直到发现汇编语言即可发现发现数据不一样了，此时需要IDA重编译功能</p>
<p>选中从头到尾的数据，按u回到字节文本状态</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20241201211159386.png" alt="image-20241201211159386"></p>
<p>后回到010EC000处即开头按p重新编译</p>
<p>后按f5即可看见函数如图</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20241201211505046.png" alt="image-20241201211505046"></p>
<p>再写一个解密脚本即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"></span><br><span class="line">int main() &#123;</span><br><span class="line">    unsigned char a[] = &#123;</span><br><span class="line">            0x1E, 0x72, 0x01, 0x73, 0x23, 0x42, 0x22, 0x43, 0x15, 0x40,</span><br><span class="line">            0x07, 0x1E, 0x68, 0x29, 0x54, 0x45, 0x5D, 0x29, 0x71, 0x67,</span><br><span class="line">            0x01, 0x28, 0x5D, 0x10, 0x7A, 0x0E, 0x49, 0x09, 0x64, 0x9C,</span><br><span class="line">            0x67, 0x44, 0x5E, 0x2A, 0x7D, 0x34, 0x4D, 0x33, 0x46, 0x14,</span><br><span class="line">            0x64, 0x0B, 0x7D, 0x3B, 0x59, 0x29, 0x06, 0x07</span><br><span class="line">    &#125;;</span><br><span class="line">    const char* k = &quot;Do_you_know_SMC?&quot;;</span><br><span class="line">    int i;</span><br><span class="line">    for (i = 0; i &lt; 48; i++) &#123;</span><br><span class="line">        a[i] ^= k[i % 16];</span><br><span class="line">    &#125;</span><br><span class="line">    for (i = 46; i &gt;= 0; i--) &#123;</span><br><span class="line">        a[i + 1] ^= a[i];</span><br><span class="line">    &#125;</span><br><span class="line">    for (i = 0; i &lt; 48; i++) &#123;</span><br><span class="line">        printf(&quot;%c&quot;, a[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="游戏高手？？"><a href="#游戏高手？？" class="headerlink" title="游戏高手？？"></a>游戏高手？？</h4><p>无壳，ida64位打开，找到主函数进入发现一堆系统函数</p>
<p>ai一下发现是类似于贪吃蛇游戏的程序没用，在函数框里面找找找发现okok函数最后printf了一个yes从它开始</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20241201212956708.png" alt="image-20241201212956708"></p>
<p>其结构大概为检查flag长度，然后在encrypt进行一个加密的过程，最后进行对比</p>
<p>对比的mi数组shift+e将其用16进制表示，去除掉00</p>
<p>发现上面存在i&lt;7部分将mi数组内的数据按照寄存器内高位低位组成8个数据</p>
<p>enc[0] &#x3D; 0xf5659330;<br>enc[1] &#x3D; 0xb0256707;<br>enc[2] &#x3D; 0x550f1326;<br>enc[3] &#x3D; 0x576294b2;<br>enc[4] &#x3D; 0xad8989bb;<br>enc[5] &#x3D; 0x75413ba0;<br>enc[6] &#x3D; 0x6d4517e0;<br>enc[7] &#x3D; 0xa1a99f25;</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20241201214519562.png" alt="image-20241201214519562"></p>
<p>点进去encrypt根据异或、加减、位移的特点发现它是tea加密算法</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20241201213307648.png" alt="image-20241201213307648"></p>
<p>从网上找一个标准的对照脚本修改一下数组和key</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">#include &lt;stdint.h&gt;</span><br><span class="line">#define delta 0x61C88647</span><br><span class="line">void Decrypt(uint32_t* enc, uint32_t* key) &#123;</span><br><span class="line">    int sum;</span><br><span class="line">    sum = 32 * delta;</span><br><span class="line">    uint32_t v1 = enc[0];</span><br><span class="line">    uint32_t v2 = enc[1];</span><br><span class="line">    for (int i = 0; i &lt; 32; i++) &#123;</span><br><span class="line">        sum -= 0x61C88647;</span><br><span class="line">        v1 += (16 * v2 + key[0]) ^ (v2 + sum) ^ ((v2 &gt;&gt; 5) + key[1]);</span><br><span class="line">        v2 += (16 * v1 + key[2]) ^ (v1 + sum) ^ ((v1 &gt;&gt; 5) + key[3]);</span><br><span class="line">    &#125;</span><br><span class="line">    enc[0] = v1;</span><br><span class="line">    enc[1] = v2;</span><br><span class="line">&#125;</span><br><span class="line">void print_chars_from_hex(unsigned int hex_value) &#123;</span><br><span class="line">    int bytes[4];</span><br><span class="line">// 逐个字节从低位到高位获取字符（小端序）</span><br><span class="line">    bytes[0] = hex_value &amp; 0xff;</span><br><span class="line">    bytes[1] = (hex_value &gt;&gt; 8) &amp; 0xff;</span><br><span class="line">    bytes[2] = (hex_value &gt;&gt; 16) &amp; 0xff;</span><br><span class="line">    bytes[3] = (hex_value &gt;&gt; 24) &amp; 0xff;</span><br><span class="line">// 打印字符</span><br><span class="line">    for (int i = 0; i &lt; 4; i++) &#123;</span><br><span class="line">        printf(&quot;%c&quot;, bytes[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">int main() &#123;</span><br><span class="line">    uint32_t key[4];</span><br><span class="line">    key[0] = 0x12345678;</span><br><span class="line">    key[1] = 0xBADF00D;</span><br><span class="line">    key[2] = 0x5201314;</span><br><span class="line">    key[3] = 0x87654321;</span><br><span class="line">    uint32_t enc[8];</span><br><span class="line">    enc[0] = 0xf5659330;</span><br><span class="line">    enc[1] = 0xb0256707;</span><br><span class="line">    enc[2] = 0x550f1326;</span><br><span class="line">    enc[3] = 0x576294b2;</span><br><span class="line">    enc[4] = 0xad8989bb;</span><br><span class="line">    enc[5] = 0x75413ba0;</span><br><span class="line">    enc[6] = 0x6d4517e0;</span><br><span class="line">    enc[7] = 0xa1a99f25;</span><br><span class="line">    for (int i = 0; i &lt; 8; i+=2) &#123;</span><br><span class="line">        Decrypt(&amp;enc[i], key);</span><br><span class="line">    &#125;</span><br><span class="line">    for (int i = 0; i &lt; 8; i++) &#123;</span><br><span class="line">        printf(&quot;enc[%d] = 0x%08x, &quot;, i, enc[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    printf(&quot;\n&quot;);</span><br><span class="line">    for (int i = 0; i &lt; 8; i++) &#123;</span><br><span class="line">        print_chars_from_hex(enc[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="rand"><a href="#rand" class="headerlink" title="rand"></a>rand</h4><p>无壳，用ida64直接打开，进入到main函数中</p>
<p>观察逻辑发现先在get_key函数中生成一个八位的密钥，然后和输入的flag进行异或，之后就进行比较数据。</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20241201215908953.png" alt="image-20241201215908953"></p>
<p>但是这里进行比较的数据为v6</p>
<p>点开发现分为两部分一半为v6的前半部分一个是后半部分</p>
<p>v6有一大坨数据而flag只有30位</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20241201215936134.png" alt="image-20241201215936134"></p>
<p>在观察后发现C4B1是重复的部分，而且去掉这部分结合后正好满足30位</p>
<p>再根据寄存器内数据由低位到高位的先后顺序可以找到数组v6</p>
<p>v6[] &#x3D; {0xC4, 0x44, 0x85, 0xCE, 0x7B, 0x37, 0xA8, 0xAB, 0xEB, 0x5C,0xA7, 0xC8, 0x0E, 0x13, 0xB1, 0xC4,0xFC, 0x32, 0x81, 0xC5, 0x7E, 0x7C, 0xA6, 0xC4, 0xD6, 0x43, 0x99, 0xD2, 0x7D,0x31}</p>
<p>点入encrypt加密那里发现是一个与刚刚随机数生成的进行异或</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20241201220631017.png" alt="image-20241201220631017"></p>
<p>然后用C语言写一个用v6数组进行这一过程的脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">int main() &#123;</span><br><span class="line">    srand(0x673F026Eu);</span><br><span class="line">    int key[8] = &#123; 0 &#125;;</span><br><span class="line">    int enc[] = &#123;0xC4, 0x44, 0x85, 0xCE, 0x7B, 0x37, 0xA8, 0xAB, 0xEB, 0x5C,</span><br><span class="line">                 0xA7, 0xC8, 0x0E, 0x13, 0xB1, 0xC4,</span><br><span class="line">                 0xFC, 0x32, 0x81, 0xC5, 0x7E, 0x7C, 0xA6, 0xC4, 0xD6, 0x43, 0x99, 0xD2, 0x7D,</span><br><span class="line">                 0x31&#125;;</span><br><span class="line">    for (int i = 0; i &lt; 8; i++) &#123;</span><br><span class="line">        key[i] = rand() % 256;</span><br><span class="line">    &#125;</span><br><span class="line">    for (int i = 0; i &lt; 30; i++) &#123;</span><br><span class="line">        printf(&quot;%c&quot;, enc[i] ^ key[i % 8]);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是这个过程在主机上怎么也找不到flag可能要在linux系统下才行</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20241201221517657.png" alt="image-20241201221517657"></p>
<p>然后在kali linux下载gcc编译器运行c文件</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20241201221738386.png" alt="image-20241201221738386"></p>
<h4 id="喜欢香香的吗比如花和茶"><a href="#喜欢香香的吗比如花和茶" class="headerlink" title="喜欢香香的吗比如花和茶"></a>喜欢香香的吗比如花和茶</h4><p>无壳，ida32位打开，进入main0函数分析一下程序可以看到前面是许多初始化然后输入加密再进行对比</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20241201233305505.png" alt="image-20241201233305505"></p>
<p>点进加密的函数可以发现是花指令，这里可以看一下花指令的处理方式<a target="_blank" rel="noopener" href="https://www.nssctf.cn/note/set/5217">https://www.nssctf.cn/note/set/5217</a></p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20241201233501025.png" alt="image-20241201233501025"></p>
<p>点进汇编语言，首先对call这行汇编按d转换成数据形式，随后把0E8修改成nop也就是0x90（edit-&gt;patch program-&gt;change byte）</p>
<p>然后按c修复修改完的这行代码，再将后边两虚线之间的部分也按c修复直至图所示</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20241201233922318.png" alt="image-20241201233922318"></p>
<p>接下来回到00411980处按p形成函数，按f5即可获得修复好的函数</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20241201234201577.png" alt="image-20241201234201577"></p>
<p>观察这一函数会发现和之前游戏高手那道简直是姐妹版</p>
<p>再加上文件名为xxtea所以可以查到为xxtea加密方式</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20241201234323796.png" alt="image-20241201234323796"></p>
<p>题中的加密是标准的在网上找一找xxtea解密的脚本修改一下带入进去即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">#include &lt;stdint.h&gt;</span><br><span class="line">#define DELTA 0x61C88647</span><br><span class="line">#define MX (((z&gt;&gt;5^y&lt;&lt;2) + (y&gt;&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[((p&amp;3)^e)&amp;0xff] ^ z)))</span><br><span class="line">void btea(uint32_t* v, int n, const uint32_t key[4])</span><br><span class="line">&#123;</span><br><span class="line">    uint32_t y, z, sum;</span><br><span class="line">    unsigned p, rounds, e;</span><br><span class="line">    if (n &gt; 1)</span><br><span class="line">    &#123;</span><br><span class="line">        rounds = 6 + 52 / n;</span><br><span class="line">        sum = 0;</span><br><span class="line">        z = v[n - 1];</span><br><span class="line">        while(rounds--&gt;0)</span><br><span class="line">        &#123;</span><br><span class="line">            sum += DELTA;</span><br><span class="line">            e = (sum &gt;&gt; 2) &amp; 3;</span><br><span class="line">            for (p = 0; p &lt; n - 1; p++)</span><br><span class="line">            &#123;</span><br><span class="line">                y = v[p + 1];</span><br><span class="line">                z = v[p] += MX;</span><br><span class="line">            &#125;</span><br><span class="line">            y = v[0];</span><br><span class="line">            z = v[n - 1] += MX;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    else if (n &lt; -1)</span><br><span class="line">    &#123;</span><br><span class="line">        n = -n;</span><br><span class="line">        rounds = 6 + 52 / n;</span><br><span class="line">        sum = -rounds * DELTA;</span><br><span class="line">        y = v[0];</span><br><span class="line">        do</span><br><span class="line">        &#123;</span><br><span class="line">            e = (sum &gt;&gt; 2) &amp; 3;</span><br><span class="line">            for (p = n - 1; p &gt; 0; p--)</span><br><span class="line">            &#123;</span><br><span class="line">                z = v[p - 1];</span><br><span class="line">                y = v[p] -= MX;</span><br><span class="line">            &#125;</span><br><span class="line">            z = v[n - 1];</span><br><span class="line">            y = v[0] -= MX;</span><br><span class="line">            sum += DELTA;</span><br><span class="line">        &#125;</span><br><span class="line">        while (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">int main() &#123;</span><br><span class="line">    unsigned char v[32];</span><br><span class="line">    v[0] = 0x7b;</span><br><span class="line">    v[1] = 0x4f;</span><br><span class="line">    v[2] = 0x36;</span><br><span class="line">    v[3] = 0xDD;</span><br><span class="line">    v[4] = 0x87;</span><br><span class="line">    v[5] = 0xEC;</span><br><span class="line">    v[6] = 0x56;</span><br><span class="line">    v[7] = 0x3A;</span><br><span class="line">    v[8] = 0x17;</span><br><span class="line">    v[9] = 0x50;</span><br><span class="line">    v[10] = 0x94;</span><br><span class="line">    v[11] = 0x69;</span><br><span class="line">    v[12] = 0xA6;</span><br><span class="line">    v[13] = 0x4E;</span><br><span class="line">    v[14] = 0x53;</span><br><span class="line">    v[15] = 0x34;</span><br><span class="line">    v[16] = 0x59;</span><br><span class="line">    v[17] = 0xD6;</span><br><span class="line">    v[18] = 0xD5;</span><br><span class="line">    v[19] = 0x17;</span><br><span class="line">    v[20] = 0x64;</span><br><span class="line">    v[21] = 0xF5;</span><br><span class="line">    v[22] = 0x2B;</span><br><span class="line">    v[23] = 9;</span><br><span class="line">    v[24] = 0x18;</span><br><span class="line">    v[25] = 0x35;</span><br><span class="line">    v[26] = 0xE1;</span><br><span class="line">    v[27] = 0x6E;</span><br><span class="line">    v[28] = 0xAE;</span><br><span class="line">    v[29] = 0x6F;</span><br><span class="line">    v[30] = 0xB4;</span><br><span class="line">    v[31] = 0xAE;</span><br><span class="line">    int r = 8;</span><br><span class="line">    uint32_t k[4];</span><br><span class="line">    k[0] = 0x1234567;</span><br><span class="line">    k[1] = 0x89ABCDEF;</span><br><span class="line">    k[2] = 0xFEDCBA98;</span><br><span class="line">    k[3] = 0x76543210;</span><br><span class="line">    btea(((uint32_t*)v),-r,k);</span><br><span class="line">    for (int i = 0; i &lt; 36; i++) &#123;</span><br><span class="line">        printf(&quot;%c&quot;,v[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id=""><a href="#" class="headerlink" title=""></a></h3>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/05/04/My-New-Post/" data-id="cma9o0lhj0000v8qkh9kx8y7j" data-title="My New Post" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%96%B0%E7%94%9F%E8%B5%9B%E7%9A%84wp/" rel="tag">新生赛的wp</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-hello-world" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/05/04/hello-world/" class="article-date">
  <time class="dt-published" datetime="2025-05-04T11:44:44.513Z" itemprop="datePublished">2025-05-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2025/05/04/hello-world/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Welcome to <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a target="_blank" rel="noopener" href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a target="_blank" rel="noopener" href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/05/04/hello-world/" data-id="cma9o0lhp0001v8qkg9mw69tw" data-title="Hello World" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  


</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%B0%E7%94%9F%E8%B5%9B%E7%9A%84wp/" rel="tag">新生赛的wp</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/%E6%96%B0%E7%94%9F%E8%B5%9B%E7%9A%84wp/" style="font-size: 10px;">新生赛的wp</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/05/">May 2025</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2025/05/04/My-New-Post/">My New Post</a>
          </li>
        
          <li>
            <a href="/2025/05/04/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2025 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>